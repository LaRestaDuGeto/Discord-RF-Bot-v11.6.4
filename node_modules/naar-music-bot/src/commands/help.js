const { MessageEmbed } = require(`discord.js`);
const db = require('quick.db');

module.exports = {
    name: `help`,
    aliases: ["h", "commands"],
    cooldown: 10,
    description: `Gives you the bot orders!.`,
    run: async(client, message, args) => {
        var prefix = db.get(`Prefix_${message.guild.id}.data`);
        if (prefix == null || undefined) db.set(`Prefix_${message.guild.id}`, { data: client.prefix })
        if (client.help_command == true) {
            let commands = message.client.commands.array();
            let embed = new MessageEmbed()
                .setAuthor("Bot Orders!", message.author.avatarURL({ dynamic: true }))
                .setFooter(client.user.username, client.user.avatarURL({ dynamic: true }))
                .setThumbnail(message.guild.iconURL({ dynamic: true }))
                .setColor(message.member.displayHexColor);
            let ifargstruedothis = -1;
            switch (args[0]) {
                case "loop":
                    ifargstruedothis = 0;
                    break;
                case "lyrics":
                    ifargstruedothis = 1
                    break;
                case "nowplaying":
                    ifargstruedothis = 2
                    break;
                case "pause":
                    ifargstruedothis = 3
                    break;
                case "play":
                    ifargstruedothis = 4
                    break;
                case "queue":
                    ifargstruedothis = 5
                    break;
                case "remove":
                    ifargstruedothis = 6
                    break;
                case "resume":
                    ifargstruedothis = 7
                    break;
                case "search":
                    ifargstruedothis = 8
                    break;
                case "skip":
                    ifargstruedothis = 9
                    break;
                case "stop":
                    ifargstruedothis = 10
                    break;
                case "volume":
                    ifargstruedothis = 12
                    break;
                case "ping":
                    ifargstruedothis = 13
                    break;
                case "help":
                    ifargstruedothis = 14
                    break;
                default:
                    commands.forEach((cmd) => {
                        embed.addField(`**${prefix}${cmd.name}**`, `\`${cmd.description}\``, true)
                    })
                    if (!message.guild) {
                        if (!args[0]) {
                            message.react("✅");
                        }
                        return;
                    }
                    if (message.member.hasPermission("ADMINISTRATOR")) {
                        embed.addField(`**${prefix}prefix**`, `\`To change the bot prefix for your guild\``, true)
                    }
                    message.react("✅")
                    if (client.dmHelpList == true) {
                        message.author.send(embed)
                    } else if (client.dmHelpList == false) {
                        message.channel.send(embed)
                    } else throw new TypeError(`❌ | "client.dmHelpList" value must be true or false`)
                    break;
            }
            if (ifargstruedothis >= 0) {
                let aliases = commands[ifargstruedothis].aliases;
                if (aliases === undefined || !aliases) aliases = "No Aliases!";
                let cooldown = commands[ifargstruedothis].cooldown;
                if (cooldown === undefined || !cooldown) cooldown = "No Cooldown!";
                embed.addField(`**:notes: Aliases:**`, `\`${aliases}\``, true);
                embed.addField(`**:wrench: Cooldown:**`, `\`${cooldown}\``, true);
                message.channel.send(embed)
            }
        } else if (client.help_command == false) {
            message.channel.send(
                new MessageEmbed()
                .setTitle(`\`${module.exports.name}\` Has Been Disabled From The Music System`)
            )
        } else throw new TypeError(`❌ | "${module.exports.name}_command" value must be true or false`)
    }
}